<template>
  <FveTemplateField>
    <input
      :type="view.type"
      :name="field.name"
      :placeholder="placeholder"
      :readonly="readonly"
      :disabled="disabled"
      :value="value.input"
      :required="field.required"
      autocomplete="off"
      @input="inputValueUpdate"
      @keypress.enter.prevent="fieldFormSubmit"
      v-bind="view.inputAttr"
      ref="input"
    />
    <div @click="showPass" class="btn-show-pass">
      <!--<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">-->
      <!--  <path v-if="this.view.type === 'password'" d="M9.89 9.89C10.485 9.298 11.188 9 12 9s1.516.297 2.11.89c.593.594.89 1.297.89 2.11s-.297 1.516-.89 2.11c-.594.593-1.297.89-2.11.89s-1.516-.297-2.11-.89C9.298 13.515 9 12.812 9 12s.297-1.516.89-2.11zm-1.453 5.672c1 .97 2.188 1.454 3.563 1.454s2.547-.485 3.516-1.453c1-1 1.5-2.188 1.5-3.563s-.5-2.547-1.5-3.516c-.97-1-2.141-1.5-3.516-1.5s-2.563.5-3.563 1.5c-.968.97-1.453 2.141-1.453 3.516s.485 2.563 1.454 3.563zm-3.14-9C7.297 5.188 9.53 4.5 12 4.5c2.469 0 4.703.688 6.703 2.063 2 1.375 3.438 3.187 4.313 5.437-.875 2.25-2.313 4.063-4.313 5.438-2 1.375-4.234 2.062-6.703 2.062-2.469 0-4.703-.688-6.703-2.063-2-1.375-3.438-3.187-4.313-5.437.875-2.25 2.313-4.063 4.313-5.438z"/>-->
      <!--  <path v-else d="M11.86 9H12c.813 0 1.516.297 2.11.89.593.594.89 1.297.89 2.11v.188L11.86 9zm-4.313.797c-.375.75-.563 1.484-.563 2.203 0 1.375.485 2.563 1.454 3.563 1 .968 2.187 1.453 3.562 1.453.719 0 1.453-.188 2.203-.563l-1.547-1.547A2.75 2.75 0 0112 15c-.813 0-1.516-.297-2.11-.89C9.298 13.515 9 12.812 9 12c0-.188.031-.406.094-.656L7.547 9.797zM2.016 4.266L3.28 3 21 20.719l-1.266 1.265c-.156-.156-.656-.64-1.5-1.453l-1.875-1.875c-1.343.563-2.797.844-4.359.844-2.469 0-4.703-.688-6.703-2.063-2-1.375-3.438-3.187-4.313-5.437.782-1.938 2.032-3.594 3.75-4.969L3.141 5.438a139.256 139.256 0 00-1.125-1.172zM12 6.984c-.625 0-1.234.125-1.828.375L8.016 5.203C9.234 4.734 10.562 4.5 12 4.5c2.469 0 4.688.688 6.656 2.063 2 1.375 3.438 3.187 4.313 5.437a12.222 12.222 0 01-3.422 4.734l-2.906-2.906c.25-.594.375-1.203.375-1.828 0-1.375-.5-2.547-1.5-3.516-.97-1-2.141-1.5-3.516-1.5z"/>-->
      <!--</svg>-->
      <template v-if="this.view.type !== 'password'">
        <svg
          width="16"
          height="16"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M11.9999 16.33C9.60992 16.33 7.66992 14.39 7.66992 12C7.66992 9.60998 9.60992 7.66998 11.9999 7.66998C14.3899 7.66998 16.3299 9.60998 16.3299 12C16.3299 14.39 14.3899 16.33 11.9999 16.33ZM11.9999 9.16998C10.4399 9.16998 9.16992 10.44 9.16992 12C9.16992 13.56 10.4399 14.83 11.9999 14.83C13.5599 14.83 14.8299 13.56 14.8299 12C14.8299 10.44 13.5599 9.16998 11.9999 9.16998Z"
          />
          <path
            d="M12.0001 21.02C8.24008 21.02 4.69008 18.82 2.25008 15C1.19008 13.35 1.19008 10.66 2.25008 8.99998C4.70008 5.17998 8.25008 2.97998 12.0001 2.97998C15.7501 2.97998 19.3001 5.17998 21.7401 8.99998C22.8001 10.65 22.8001 13.34 21.7401 15C19.3001 18.82 15.7501 21.02 12.0001 21.02ZM12.0001 4.47998C8.77008 4.47998 5.68008 6.41998 3.52008 9.80998C2.77008 10.98 2.77008 13.02 3.52008 14.19C5.68008 17.58 8.77008 19.52 12.0001 19.52C15.2301 19.52 18.3201 17.58 20.4801 14.19C21.2301 13.02 21.2301 10.98 20.4801 9.80998C18.3201 6.41998 15.2301 4.47998 12.0001 4.47998Z"
          />
        </svg> </template
      ><template v-else>
        <svg
          width="16"
          height="16"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M9.46992 15.28C9.27992 15.28 9.08992 15.21 8.93992 15.06C8.11992 14.24 7.66992 13.15 7.66992 12C7.66992 9.60998 9.60992 7.66998 11.9999 7.66998C13.1499 7.66998 14.2399 8.11998 15.0599 8.93998C15.1999 9.07998 15.2799 9.26998 15.2799 9.46998C15.2799 9.66998 15.1999 9.85998 15.0599 9.99998L9.99992 15.06C9.84992 15.21 9.65992 15.28 9.46992 15.28ZM11.9999 9.16998C10.4399 9.16998 9.16992 10.44 9.16992 12C9.16992 12.5 9.29992 12.98 9.53992 13.4L13.3999 9.53998C12.9799 9.29998 12.4999 9.16998 11.9999 9.16998Z"
          />
          <path
            d="M5.59984 18.51C5.42984 18.51 5.24984 18.45 5.10984 18.33C4.03984 17.42 3.07984 16.3 2.25984 15C1.19984 13.35 1.19984 10.66 2.25984 8.99998C4.69984 5.17998 8.24984 2.97998 11.9998 2.97998C14.1998 2.97998 16.3698 3.73998 18.2698 5.16998C18.5998 5.41998 18.6698 5.88998 18.4198 6.21998C18.1698 6.54998 17.6998 6.61998 17.3698 6.36998C15.7298 5.12998 13.8698 4.47998 11.9998 4.47998C8.76984 4.47998 5.67984 6.41998 3.51984 9.80998C2.76984 10.98 2.76984 13.02 3.51984 14.19C4.26984 15.36 5.12984 16.37 6.07984 17.19C6.38984 17.46 6.42984 17.93 6.15984 18.25C6.01984 18.42 5.80984 18.51 5.59984 18.51Z"
          />
          <path
            d="M12.0001 21.02C10.6701 21.02 9.37006 20.75 8.12006 20.22C7.74006 20.06 7.56006 19.62 7.72006 19.24C7.88006 18.86 8.32006 18.68 8.70006 18.84C9.76006 19.29 10.8701 19.52 11.9901 19.52C15.2201 19.52 18.3101 17.58 20.4701 14.19C21.2201 13.02 21.2201 10.98 20.4701 9.81C20.1601 9.32 19.8201 8.85 19.4601 8.41C19.2001 8.09 19.2501 7.62 19.5701 7.35C19.8901 7.09 20.3601 7.13 20.6301 7.46C21.0201 7.94 21.4001 8.46 21.7401 9C22.8001 10.65 22.8001 13.34 21.7401 15C19.3001 18.82 15.7501 21.02 12.0001 21.02Z"
          />
          <path
            d="M12.6901 16.27C12.3401 16.27 12.0201 16.02 11.9501 15.66C11.8701 15.25 12.1401 14.86 12.5501 14.79C13.6501 14.59 14.5701 13.67 14.7701 12.57C14.8501 12.16 15.2401 11.9 15.6501 11.97C16.0601 12.05 16.3301 12.44 16.2501 12.85C15.9301 14.58 14.5501 15.95 12.8301 16.27C12.7801 16.26 12.7401 16.27 12.6901 16.27Z"
          />
          <path
            d="M1.99994 22.75C1.80994 22.75 1.61994 22.68 1.46994 22.53C1.17994 22.24 1.17994 21.76 1.46994 21.47L8.93994 14C9.22994 13.71 9.70994 13.71 9.99994 14C10.2899 14.29 10.2899 14.77 9.99994 15.06L2.52994 22.53C2.37994 22.68 2.18994 22.75 1.99994 22.75Z"
          />
          <path
            d="M14.5302 10.22C14.3402 10.22 14.1502 10.15 14.0002 10C13.7102 9.71 13.7102 9.23 14.0002 8.94L21.4702 1.47C21.7602 1.18 22.2402 1.18 22.5302 1.47C22.8202 1.76 22.8202 2.24 22.5302 2.53L15.0602 10C14.9102 10.15 14.7202 10.22 14.5302 10.22Z"
          />
        </svg>
      </template>
    </div>
  </FveTemplateField>
</template>

<script>
import FveText from './FveText';

export default {
  name: 'FvePasswordShowPass',
  mixins: [FveText],
  props: {
    fixAc: {type: Boolean, required: false}
  },
  data() {
    return {
      view: {
        type: this.fixAc ? 'text' : 'password',
        inputAttr: {},
      },
    };
  },
  methods: {
    showPass() {
      if (this.view.type === 'password') {
        this.view.type = 'text';
      } else {
        this.view.type = 'password';
      }
    },

    validate(valueObj) {
      const min = 6;
      if (valueObj.input.length < min) {
        return {
          status: 'ERROR',
          code: 'VALIDATE',
          message: 'Длинна строки не менее ' + min + ' символов',
        };
      }
    },
  },
  mounted() {
    if(this.fixAc) {
      setTimeout(() => {
        this.view.type = 'password';
      }, 400);
    }
  }
};
</script>

<style lang="scss" scoped>
@import '~@field/style/inputText.scss';

.btn-show-pass {
  position: absolute;
  right: 0;
  top: 0;
  cursor: pointer;
  z-index: 12;
  height: 100%;
  border-radius: 0 8px 8px 0;
  padding: 0 17px;
  display: flex;
  align-items: center;
  & > svg {
    fill: var(--fve-placeholder--font-color);
  }
  &:hover > svg {
    fill: var(--color-gray-04-hover);
  }
}
</style>
